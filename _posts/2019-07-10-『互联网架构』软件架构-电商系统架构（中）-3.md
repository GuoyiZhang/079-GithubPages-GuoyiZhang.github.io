---
layout:     post
title:      『互联网架构』软件架构-电商系统架构（中）-3
subtitle:   『互联网架构』软件架构-电商系统架构（中）-3
date:       2019-07-10 11:18:29
author:     Sunny day
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - 解密电商系统架构
---

>『互联网架构』软件架构-电商系统架构（中）-3

# 『互联网架构』软件架构-电商系统架构（中）-3

docker的方式安装了nexus，gogs和正常的方式安装jenkins，下面一起说说tomcat的持续集成，和3者之前项目的贯通。接上节，请勿别单独看本节。源码：[https://github.com/limingios/netFuture/tree/master/jenkins+nexus+gogs](https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Flimingios%2FnetFuture%2Ftree%2Fmaster%2Fjenkins%2Bnexus%2Bgogs)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0yNTgwZGQ5ZTM3NTI3OTY3LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvODY5L2Zvcm1hdC93ZWJw?x-oss-process=image/format,png)

（一）继续集成环境按钮

* 1.安装jdk 和 tomcat（192.168.72.104）
安装jdk1.8
 
yum install -y wget wget --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie" "http://download.oracle.com/otn-pub/java/jdk/8u141-b15/336fa29ff2bb4ef291e347e091f7f4a7/jdk-8u141-linux-x64.tar.gz" /#上边的下载比较慢，建议不通过wget的方式，本地下载后上传上去，我下载了3个多小时，当时正好想看电视剧看了几集 tar -zxvf jdk/* cd jdk/* /#获取jdk目录填写到下面JAVA_HOME中 pwd /#追加环境变量 echo "export JAVA_HOME=/root/jdk1.8.0_141" >> /etc/profile echo "export PATH=$""JAVA_HOME/bin:$""PATH" >> /etc/profile /#执行下面这个才能生效 source /etc/profile java -version javac -version

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1jMjU3ZTRjNjgwNjI0ZjMyLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS00MjQ1NjM2NDcwNjA2ZjFlLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0wMmRiMWVhODYzOTI5MTZkLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)
安装tomcat
 
cd ~ /#wget tomcat下载的时候很快 wget https://mirrors.cnnic.cn/apache/tomcat/tomcat-7/v7.0.94/bin/apache-tomcat-7.0.94.tar.gz tar -zxvf apache-tomcat/* /#运行下tomcat看能否启用 cd apache-tomcat/* cd bin ./catalina.sh start

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0zNDA3MWMxZDRlYWExZTUyLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0yODEzNjVhYTFiZGY0NDkzLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

* 2.jenkins中的maven配置私服地址（192.168.72.102）
在虚拟机内查看maven的配置地址Nexus3.x，配置跟nexus2不同。源码中有下载好的settings.xml。修改下ip就可以自己来用。
 
mvn --version

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1iNzBiYjBiMjExMDI3MjRmLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

maven安装路径下的conf/settings.xml文件
 
cd /opt/soft/maven-3.2.3/conf vi settings.xml

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1mOGQyMTQxMmMyNTQyZjcyLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

settings.xml 配置
mirrors中添加
 
<mirror> <id>nexus</id> <mirrorOf>/*</mirrorOf> <!-- ip 更换成192.168.72.103--> <url>http://192.168.72.103:8081/repository/maven-public/</url> </mirror>

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1iNzMzNzQ4ZDc0OTAyY2MyLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

找到<servers>节点添加
 
<server> <id>nexus</id> <username>admin</username> <password>admin123</password> </server>

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1jMjFjYjQwZTY0YjA2ODdhLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

找到<profiles>节点增加
 
<profile> <id>nexus</id> <repositories> <repository> <id>nexus</id> <name>Nexus</name> <url>http://192.168.72.103:8081/repository/maven-public/</url> <releases> <enabled>true</enabled> <updatePolicy>always</updatePolicy> </releases> <snapshots> <enabled>true</enabled> <updatePolicy>always</updatePolicy> </snapshots> </repository> </repositories> <pluginRepositories> <pluginRepository> <id>nexus</id> <name>Nexus</name> <url>http://192.168.72.103:8081/repository/maven-public/</url> <releases> <enabled>true</enabled> </releases> <snapshots> <enabled>true</enabled> </snapshots> </pluginRepository> </pluginRepositories> </profile>

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS00MjFmNDQyMDJkMTFhNTNjLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

在</profiles>之后增加
 
<activeProfiles> <activeProfile>nexus</activeProfile> </activeProfiles>

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS01ODM2NjYzY2Q1OGJmOWVjLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

jenkins配置JDK和Maven
系统管理-全局工具配置

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS04NDkwMTk2YjljOTRkZjJjLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

JDK配置

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1mNDliZGVhNDIxYmViNmY0LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

java -version echo $JAVA_HOME

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS04ZTI5ZTU2OWU4ZGJjMjYxLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1kOThjOGIyMDNmMThmMjliLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)
Maven配置

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS05OGUxYjk1YTkxOWFjZTkxLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

mvn -version echo $MAVEN_HOME

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0wMzczNDM2M2M2MWU0ZDhjLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

* 3.nexus中的maven配置私服地址（192.168.72.103）
在仓库中,默认会在本地去查找插件,当未发现有插件时,会去第三方仓库查找,跟系统上的yum挺像!当本地内未能查找到相应的插件,会通过代理(proxy)类型进行下载插件,配置就在Central-->Remote Storage 。

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0yMjhiY2EwNjg1NTc3ZjZlLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

点击进入

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0xNWIxZTliMGZiZWYwYWRjLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

（不建议修改）将其改为阿里云的maven远程仓库：[http://maven.aliyun.com/nexus/content/groups/public/](https://links.jianshu.com/go?to=http%3A%2F%2Fmaven.aliyun.com%2Fnexus%2Fcontent%2Fgroups%2Fpublic%2F)
老铁，其实阿里毕竟是镜像库，很多时候在阿里远程仓库中下载不下来，但是maven仓库是可以下载的。不建议修改，如果网络速度特别low的时候，可以先用这个阿里的方式。
[https://repo1.maven.org/maven2/](https://links.jianshu.com/go?to=https%3A%2F%2Frepo1.maven.org%2Fmaven2%2F)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0yZjY1MmU0YzY0MTFiOGYwLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1kYWY0NTFmMjY0Yjk0MDIzLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)
增加第三方库，为的是生成的jar或者war包，可以上传到私服上。起个名字叫：3rd_part 自己定义的，后面上传你的时候需要。

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1iODNlNjQ0YzgzZWNkMThhLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1iM2M3Y2MxMjIwZTE0YWYxLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)
填入名字，Deployment pollcy(Allow redeploy)允许更新，后保存
不设置allow redeploy，会爆400错误。

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS02Y2JlODdkYzJhZmQyNGUwLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1lMjAxYzcyOTVlYWYyODdjLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)
maven-public

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0zZjY0NmFlZWIzNTBmZTZiLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

将group中的3rd_part 移动到 Members下

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS04NDcwMzg4NzM1ZDM4YTc1LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1hNDNiODFmNWMzYjYzOTVmLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

* 4.jenkins的测试配置，看是否从私服下载，并看看私服的变化

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0yOTFlMzMzMTMwYTIzZjc3LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS01NWI0NDU2YjU2NzE4MTZlLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1mN2NlNmYxMWQ0Mzg0NThhLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)
远程git下载的同户名和密码

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS1lZGJkOTRjZGMwMzkxOWYzLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

下拉选择git的设置的用户名和密码

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS02OTVkODQ3OWQ2MmQzYzFlLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

填写Build内容
 
clean install -Dmaven.test.skip=true -e -U

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS02OGIxNTkzOGUwNjU2ODQ1LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

点击立即构建

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0zMTdjN2I0MTQzMDNmN2ZjLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

点击正在构建的任务

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS05ZTkyYTVlNTEwYjgyODBkLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

查看控制台输出

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS05OGQxOWMzNmZlODU2NGY0LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

nexus3的变化

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS03Yzg5NWY3MmRlN2VlNGE0LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

jenkins的构建信息

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0wOTZiMTYwYWE3ZmZmYjA2LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

构建结果

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS05NjNmYTNjZTQxM2Y1ZjcwLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

在192.168.72.102机器上，使用命令进行上传
 
/# Dfile路径就是jenkins打包后的成功路径 mvn deploy:deploy-file -DgroupId=com.test -DartifactId=example -Dversion=1.0.0 -Dpackaging=jar -Dfile=/root/.jenkins/workspace/abc-test/target/guns.jar -Durl=http://192.168.72.103:8081/repository/3rd_part/ -DrepositoryId=nexus

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS01Zjg4MDRjNGVjM2MyMmRhLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

新建立的3rd_part仓库里已经上传成功

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0xZDczOTZlMjcwZTA0NWI4LnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

* 5.jenkins（192.168.72.102）加上上面的命令
任务中增加编译后的shell脚本
 
mvn deploy:deploy-file -DgroupId=com.test -DartifactId=example -Dversion=1.0.0 -Dpackaging=jar -Dfile=/root/.jenkins/workspace/abc-test/target/guns.jar -Durl=http://192.168.72.103:8081/repository/3rd_part/ -DrepositoryId=nexus

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS00MTVhZjJiNThjMDZiMmYwLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS05YTU2YTY4M2FkYmQ1ODIzLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)
立即构建，查看输出末尾有uploaded操作。

![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xMTIyMzcxNS0wMjNjZTQwOTFjOWYzZDEwLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTAwMC9mb3JtYXQvd2VicA?x-oss-process=image/format,png)

PS：基本的流程已经构建完成了。jenkins已经跟私服连接上了。下一步就从tomcat关联上jenkins构建后的war包或者jar包。
几个重点需要注意点
0.这里使用的是nexus3，跟nexus2还是有区别的。特别是私服的settings.xml设置这块。
1.settings的设置【参考源码中的settings.xml文件】
2.nexus新建仓库允许更新操作
3.上传项目打包后的war或者jar包的时候，命令
4.构建的时候的命令建议先clean 然后install，跳过test。

作者：IT人故事会
链接：https://www.jianshu.com/p/a6bfd1841890
来源：简书
简书著作权归作者所有，任何形式的转载都请联系作者获得授权并注明出处。


